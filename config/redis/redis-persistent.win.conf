# QMS-AI RedisæŒä¹…åŒ–é…ç½®æ–‡ä»?# ä¸“ä¸ºQMS-AIç³»ç»Ÿä¼˜åŒ–çš„Redisé…ç½®

# ç½‘ç»œé…ç½®
bind 0.0.0.0
port 6380
tcp-backlog 511
timeout 0
tcp-keepalive 300

# é€šç”¨é…ç½®
daemonize yes
pidfile /tmp/redis_6380.pid
loglevel notice
logfile ""
databases 16

# æŒä¹…åŒ–é…ç½?- RDBå¿«ç…§
save 900 1      # 900ç§’å†…è‡³å°‘1ä¸ªkeyå˜åŒ–æ—¶ä¿å­?save 300 10     # 300ç§’å†…è‡³å°‘10ä¸ªkeyå˜åŒ–æ—¶ä¿å­?save 60 10000   # 60ç§’å†…è‡³å°‘10000ä¸ªkeyå˜åŒ–æ—¶ä¿å­?stop-writes-on-bgsave-error yes
rdbcompression yes
rdbchecksum yes
dbfilename qms-ai-dump.rdb
dir /mnt/d/QMS01/tmp/redis-data

# æŒä¹…åŒ–é…ç½?- AOFæ—¥å¿—
appendonly yes
appendfilename "qms-ai-appendonly.aof"
appendfsync everysec
no-appendfsync-on-rewrite no
auto-aof-rewrite-percentage 100
auto-aof-rewrite-min-size 64mb
aof-load-truncated yes
aof-use-rdb-preamble yes

# å†…å­˜ç®¡ç†
maxmemory 512mb
maxmemory-policy allkeys-lru
maxmemory-samples 5

# å®‰å…¨é…ç½®
# requirepass qms_ai_redis_2025
# å¦‚æœéœ€è¦å¯†ç ï¼Œè¯·å–æ¶ˆæ³¨é‡Šä¸Šé¢ä¸€è¡?
# å®¢æˆ·ç«¯é…ç½?maxclients 10000

# æ…¢æŸ¥è¯¢æ—¥å¿?slowlog-log-slower-than 10000
slowlog-max-len 128

# å»¶è¿Ÿç›‘æ§
latency-monitor-threshold 100

# äº‹ä»¶é€šçŸ¥
notify-keyspace-events Ex

# é«˜çº§é…ç½®
hash-max-ziplist-entries 512
hash-max-ziplist-value 64
list-max-ziplist-size -2
list-compress-depth 0
set-max-intset-entries 512
zset-max-ziplist-entries 128
zset-max-ziplist-value 64
hll-sparse-max-bytes 3000
stream-node-max-bytes 4096
stream-node-max-entries 100

# æ´»è·ƒé‡æ–°å“ˆå¸Œ
activerehashing yes

# å®¢æˆ·ç«¯è¾“å‡ºç¼“å†²åŒºé™åˆ¶
client-output-buffer-limit normal 0 0 0
client-output-buffer-limit replica 256mb 64mb 60
client-output-buffer-limit pubsub 32mb 8mb 60

# å®¢æˆ·ç«¯æŸ¥è¯¢ç¼“å†²åŒºé™åˆ¶
client-query-buffer-limit 1gb

# åè®®æœ€å¤§æ‰¹é‡è¯·æ±‚å¤§å°?proto-max-bulk-len 512mb

# HZé¢‘ç‡
hz 10

# åŠ¨æ€HZ
dynamic-hz yes

# AOFé‡å†™å¢é‡fsync
aof-rewrite-incremental-fsync yes

# RDBä¿å­˜å¢é‡fsync
rdb-save-incremental-fsync yes

# LFUå’ŒLRUç²¾åº¦
lfu-log-factor 10
lfu-decay-time 1

# æƒ°æ€§é‡Šæ”?lazyfree-lazy-eviction no
lazyfree-lazy-expire no
lazyfree-lazy-server-del no
replica-lazy-flush no

# çº¿ç¨‹I/O
io-threads 4
io-threads-do-reads yes

# QMS-AIä¸“ç”¨é…ç½®æ³¨é‡Š
# æ­¤é…ç½®æ–‡ä»¶ä¸“ä¸ºQMS-AIç³»ç»Ÿä¼˜åŒ–
# åŒ…å«ä»¥ä¸‹ç‰¹æ€§ï¼š
# 1. åŒé‡æŒä¹…åŒ–ï¼šRDB + AOF
# 2. å†…å­˜ä¼˜åŒ–ï¼?12MBé™åˆ¶ï¼ŒLRUç­–ç•¥
# 3. æ€§èƒ½ä¼˜åŒ–ï¼šå¤šçº¿ç¨‹I/Oï¼ŒåŠ¨æ€HZ
# 4. ç›‘æ§æ”¯æŒï¼šæ…¢æŸ¥è¯¢æ—¥å¿—ï¼Œå»¶è¿Ÿç›‘æ?# 5. å®‰å…¨é…ç½®ï¼šå¯é€‰å¯†ç ä¿æŠ?
