# ğŸš€ QMS-AIæ¸è¿›å¼éƒ¨ç½²æŒ‡å—

## ğŸ“Š éƒ¨ç½²ç­–ç•¥æ¦‚è§ˆ

**ç›®æ ‡**: ä»æœ¬åœ°å¼€å‘å¹³æ»‘è¿‡æ¸¡åˆ°äº‘ç«¯ç”Ÿäº§ç¯å¢ƒ  
**åŸåˆ™**: æ¸è¿›å¼ã€ä½é£é™©ã€æ˜“ç»´æŠ¤  
**é€‚ç”¨**: è½¯ä»¶å¼€å‘æ–°æ‰‹å’Œå¿«é€Ÿè¿­ä»£é¡¹ç›®

---

## ğŸ¯ ä¸‰é˜¶æ®µéƒ¨ç½²ç­–ç•¥

### é˜¶æ®µä¸€ï¼šæœ¬åœ°å®¹å™¨åŒ– (æ¨èå½“å‰æ‰§è¡Œ)
**æ—¶é—´**: 1-2å¤©  
**é£é™©**: æä½  
**ç›®æ ‡**: ç»Ÿä¸€å¼€å‘ç¯å¢ƒï¼Œä¸ºäº‘ç«¯éƒ¨ç½²åšå‡†å¤‡

### é˜¶æ®µäºŒï¼šå•æœºäº‘ç«¯éƒ¨ç½² (åŠŸèƒ½ç¨³å®šå)
**æ—¶é—´**: 1-3å¤©  
**é£é™©**: ä½  
**ç›®æ ‡**: ä½“éªŒäº‘ç«¯ç¯å¢ƒï¼Œå­¦ä¹ è¿ç»´çŸ¥è¯†

### é˜¶æ®µä¸‰ï¼šç”Ÿäº§çº§äº‘ç«¯éƒ¨ç½² (æ­£å¼ä¸Šçº¿å‰)
**æ—¶é—´**: 3-7å¤©  
**é£é™©**: ä¸­ç­‰  
**ç›®æ ‡**: é«˜å¯ç”¨ã€å¯æ‰©å±•çš„ç”Ÿäº§ç¯å¢ƒ

---

## ğŸ³ é˜¶æ®µä¸€ï¼šæœ¬åœ°å®¹å™¨åŒ–è¯¦ç»†æŒ‡å—

### 1. å®‰è£…Docker Desktop
**Windowsç”¨æˆ·**:
1. ä¸‹è½½Docker Desktop: https://www.docker.com/products/docker-desktop
2. å®‰è£…å¹¶å¯åŠ¨Docker Desktop
3. éªŒè¯å®‰è£…: `docker --version`

### 2. åˆ›å»ºç®€åŒ–çš„Dockeré…ç½®

#### 2.1 åˆ›å»ºä¸»æœåŠ¡Dockerfile
```dockerfile
# backend/nodejs/Dockerfile
FROM node:18-alpine

WORKDIR /app

# å¤åˆ¶packageæ–‡ä»¶
COPY package*.json ./

# å®‰è£…ä¾èµ–
RUN npm install --production

# å¤åˆ¶æºä»£ç 
COPY . .

# æš´éœ²ç«¯å£
EXPOSE 3004

# å¯åŠ¨å‘½ä»¤
CMD ["node", "chat-service.js"]
```

#### 2.2 åˆ›å»ºç®€åŒ–çš„docker-compose.yml
```yaml
# docker-compose.local.yml
version: '3.8'

services:
  # QMSèŠå¤©æœåŠ¡
  qms-chat:
    build: ./backend/nodejs
    ports:
      - "3004:3004"
    environment:
      - NODE_ENV=development
      - DB_TYPE=sqlite
      - CACHE_ENABLED=false
    volumes:
      - ./backend/nodejs:/app
      - /app/node_modules
    restart: unless-stopped

  # QMSå‰ç«¯åº”ç”¨
  qms-frontend:
    build: ./frontend/åº”ç”¨ç«¯
    ports:
      - "8080:8080"
    volumes:
      - ./frontend/åº”ç”¨ç«¯:/app
      - /app/node_modules
    restart: unless-stopped

  # QMSé…ç½®ç«¯
  qms-config:
    build: ./frontend/é…ç½®ç«¯
    ports:
      - "8072:8072"
    volumes:
      - ./frontend/é…ç½®ç«¯:/app
      - /app/node_modules
    restart: unless-stopped

volumes:
  qms_data:
```

### 3. æœ¬åœ°å®¹å™¨åŒ–çš„ä¼˜åŠ¿
- âœ… **ç¯å¢ƒéš”ç¦»**: æ¯ä¸ªæœåŠ¡ç‹¬ç«‹è¿è¡Œ
- âœ… **ä¸€é”®å¯åŠ¨**: `docker-compose up -d`
- âœ… **ä¾¿äºè°ƒè¯•**: ä»£ç çƒ­é‡è½½
- âœ… **èµ„æºæ§åˆ¶**: å¯ä»¥é™åˆ¶CPUå’Œå†…å­˜ä½¿ç”¨
- âœ… **ä¸ºäº‘ç«¯åšå‡†å¤‡**: é…ç½®å¯ç›´æ¥ç”¨äºæœåŠ¡å™¨

---

## â˜ï¸ é˜¶æ®µäºŒï¼šå•æœºäº‘ç«¯éƒ¨ç½²æŒ‡å—

### 1. é˜¿é‡Œäº‘ECSé€‰æ‹©å»ºè®®
**æ¨èé…ç½®** (å¼€å‘æµ‹è¯•ç”¨):
- **å®ä¾‹è§„æ ¼**: ecs.t6-c1m2.large (2æ ¸4GB)
- **æ“ä½œç³»ç»Ÿ**: Ubuntu 20.04 LTS
- **å­˜å‚¨**: 40GB SSDäº‘ç›˜
- **ç½‘ç»œ**: æŒ‰ä½¿ç”¨æµé‡è®¡è´¹
- **é¢„ä¼°è´¹ç”¨**: çº¦200-300å…ƒ/æœˆ

### 2. æœåŠ¡å™¨ç¯å¢ƒå‡†å¤‡
```bash
# 1. æ›´æ–°ç³»ç»Ÿ
sudo apt update && sudo apt upgrade -y

# 2. å®‰è£…Docker
curl -fsSL https://get.docker.com -o get-docker.sh
sudo sh get-docker.sh
sudo usermod -aG docker $USER

# 3. å®‰è£…Docker Compose
sudo curl -L "https://github.com/docker/compose/releases/download/v2.20.0/docker-compose-$(uname -s)-$(uname -m)" -o /usr/local/bin/docker-compose
sudo chmod +x /usr/local/bin/docker-compose

# 4. å®‰è£…Git
sudo apt install git -y
```

### 3. ä»£ç éƒ¨ç½²æµç¨‹
```bash
# 1. å…‹éš†ä»£ç 
git clone <your-repo-url> qms-ai
cd qms-ai

# 2. å¯åŠ¨æœåŠ¡
docker-compose -f docker-compose.local.yml up -d

# 3. æŸ¥çœ‹æœåŠ¡çŠ¶æ€
docker-compose ps

# 4. æŸ¥çœ‹æ—¥å¿—
docker-compose logs -f qms-chat
```

### 4. åŸŸåå’ŒSSLé…ç½® (å¯é€‰)
```bash
# 1. å®‰è£…Nginx
sudo apt install nginx -y

# 2. é…ç½®åå‘ä»£ç†
sudo nano /etc/nginx/sites-available/qms-ai

# 3. ç”³è¯·SSLè¯ä¹¦ (Let's Encrypt)
sudo apt install certbot python3-certbot-nginx -y
sudo certbot --nginx -d your-domain.com
```

---

## ğŸ­ é˜¶æ®µä¸‰ï¼šç”Ÿäº§çº§äº‘ç«¯éƒ¨ç½²æŒ‡å—

### 1. é˜¿é‡Œäº‘äº§å“é€‰æ‹©
**æ¨èæ¶æ„**:
- **ECS**: 2å°å®ä¾‹åšè´Ÿè½½å‡è¡¡
- **RDS**: PostgreSQLæ•°æ®åº“
- **Redis**: ç¼“å­˜æœåŠ¡
- **SLB**: è´Ÿè½½å‡è¡¡å™¨
- **OSS**: å¯¹è±¡å­˜å‚¨
- **CDN**: å†…å®¹åˆ†å‘ç½‘ç»œ

### 2. é«˜å¯ç”¨éƒ¨ç½²æ¶æ„
```
Internet
    â†“
[SLBè´Ÿè½½å‡è¡¡]
    â†“
[ECS-1] [ECS-2]
    â†“
[RDS PostgreSQL] [Redis]
    â†“
[OSSå¯¹è±¡å­˜å‚¨]
```

---

## ğŸ› ï¸ ç»´æŠ¤å’Œæ›´æ–°ç­–ç•¥

### æœ¬åœ°å¼€å‘æ—¶çš„æ›´æ–°æµç¨‹
```bash
# 1. ä¿®æ”¹ä»£ç åé‡å¯æœåŠ¡
docker-compose restart qms-chat

# 2. æŸ¥çœ‹å®æ—¶æ—¥å¿—
docker-compose logs -f qms-chat

# 3. è¿›å…¥å®¹å™¨è°ƒè¯•
docker-compose exec qms-chat sh
```

### äº‘ç«¯æ›´æ–°æµç¨‹
```bash
# 1. æ‹‰å–æœ€æ–°ä»£ç 
git pull origin main

# 2. é‡æ–°æ„å»ºé•œåƒ
docker-compose build

# 3. æ»šåŠ¨æ›´æ–°æœåŠ¡
docker-compose up -d --no-deps qms-chat

# 4. éªŒè¯æœåŠ¡çŠ¶æ€
curl http://localhost:3004/health
```

---

## ğŸ“Š æˆæœ¬é¢„ä¼°

### æœ¬åœ°å¼€å‘æˆæœ¬
- **ç¡¬ä»¶è¦æ±‚**: 8GBå†…å­˜ï¼Œ4æ ¸CPU
- **è½¯ä»¶æˆæœ¬**: å…è´¹ (Docker Desktopä¸ªäººç‰ˆ)
- **æ—¶é—´æˆæœ¬**: 1-2å¤©å­¦ä¹ å’Œé…ç½®

### äº‘ç«¯éƒ¨ç½²æˆæœ¬ (æœˆè´¹ç”¨)
| é˜¶æ®µ | é…ç½® | é¢„ä¼°è´¹ç”¨ | é€‚ç”¨åœºæ™¯ |
|------|------|----------|----------|
| é˜¶æ®µäºŒ | å•æœºECS | 200-300å…ƒ | å¼€å‘æµ‹è¯• |
| é˜¶æ®µä¸‰ | é«˜å¯ç”¨æ¶æ„ | 800-1500å…ƒ | ç”Ÿäº§ç¯å¢ƒ |

---

## ğŸ¯ æ¨èçš„å®æ–½è®¡åˆ’

### ç¬¬1å‘¨ï¼šæœ¬åœ°å®¹å™¨åŒ–
- [ ] å®‰è£…Docker Desktop
- [ ] åˆ›å»ºDockerfileå’Œdocker-compose.yml
- [ ] æµ‹è¯•æœ¬åœ°å®¹å™¨åŒ–éƒ¨ç½²
- [ ] ç†Ÿæ‚‰DockeråŸºæœ¬å‘½ä»¤

### ç¬¬2-3å‘¨ï¼šåŠŸèƒ½å®Œå–„
- [ ] ç»§ç»­æœ¬åœ°å¼€å‘å’Œæµ‹è¯•
- [ ] å®Œå–„åŠŸèƒ½å’Œä¿®å¤bug
- [ ] å‡†å¤‡äº‘ç«¯éƒ¨ç½²é…ç½®

### ç¬¬4å‘¨ï¼šäº‘ç«¯éƒ¨ç½² (åŠŸèƒ½ç›¸å¯¹ç¨³å®šå)
- [ ] è´­ä¹°é˜¿é‡Œäº‘ECS
- [ ] éƒ¨ç½²åˆ°äº‘ç«¯æµ‹è¯•ç¯å¢ƒ
- [ ] é…ç½®åŸŸåå’ŒSSL
- [ ] ç›‘æ§å’Œæ—¥å¿—é…ç½®

---

## ğŸš¨ é£é™©æ§åˆ¶å»ºè®®

### 1. æ•°æ®å¤‡ä»½ç­–ç•¥
```bash
# æœ¬åœ°æ•°æ®å¤‡ä»½
docker-compose exec qms-chat cp /app/chat_history.db /backup/

# äº‘ç«¯æ•°æ®å¤‡ä»½
# ä½¿ç”¨é˜¿é‡Œäº‘RDSè‡ªåŠ¨å¤‡ä»½åŠŸèƒ½
```

### 2. å›æ»šç­–ç•¥
```bash
# å¿«é€Ÿå›æ»šåˆ°ä¸Šä¸€ä¸ªç‰ˆæœ¬
git checkout HEAD~1
docker-compose up -d --build
```

### 3. ç›‘æ§å‘Šè­¦
- ä½¿ç”¨é˜¿é‡Œäº‘ç›‘æ§æœåŠ¡
- è®¾ç½®CPUã€å†…å­˜ã€ç£ç›˜ä½¿ç”¨ç‡å‘Šè­¦
- é…ç½®æœåŠ¡å¯ç”¨æ€§ç›‘æ§

---

## ğŸ’¡ æ–°æ‰‹å‹å¥½çš„å­¦ä¹ è·¯å¾„

### å¿…å­¦æŠ€èƒ½ (æŒ‰ä¼˜å…ˆçº§)
1. **DockeråŸºç¡€** (1-2å¤©)
   - å®¹å™¨æ¦‚å¿µ
   - åŸºæœ¬å‘½ä»¤
   - docker-composeä½¿ç”¨

2. **LinuxåŸºç¡€** (2-3å¤©)
   - æ–‡ä»¶æ“ä½œ
   - è¿›ç¨‹ç®¡ç†
   - ç½‘ç»œé…ç½®

3. **Nginxé…ç½®** (1å¤©)
   - åå‘ä»£ç†
   - SSLé…ç½®
   - è´Ÿè½½å‡è¡¡

4. **äº‘æœåŠ¡ä½¿ç”¨** (2-3å¤©)
   - ECSç®¡ç†
   - å®‰å…¨ç»„é…ç½®
   - åŸŸåè§£æ

### å­¦ä¹ èµ„æºæ¨è
- **Dockerå®˜æ–¹æ•™ç¨‹**: https://docs.docker.com/get-started/
- **é˜¿é‡Œäº‘å¤§å­¦**: https://edu.aliyun.com/
- **èœé¸Ÿæ•™ç¨‹Linux**: https://www.runoob.com/linux/linux-tutorial.html

---

## ğŸŠ æ€»ç»“å»ºè®®

### å½“å‰æœ€ä½³é€‰æ‹©ï¼šé˜¶æ®µä¸€æœ¬åœ°å®¹å™¨åŒ–
**ç†ç”±**:
1. **é£é™©æœ€ä½** - ä¸å½±å“ç°æœ‰å¼€å‘ç¯å¢ƒ
2. **å­¦ä¹ æˆæœ¬ä½** - é€æ­¥æŒæ¡DockeræŠ€èƒ½
3. **ä¾¿äºè°ƒè¯•** - æœ¬åœ°ç¯å¢ƒä¾¿äºé—®é¢˜æ’æŸ¥
4. **ä¸ºäº‘ç«¯åšå‡†å¤‡** - é…ç½®å¯ç›´æ¥è¿ç§»åˆ°æœåŠ¡å™¨

### ä½•æ—¶è€ƒè™‘äº‘ç«¯éƒ¨ç½²
- âœ… åŠŸèƒ½ç›¸å¯¹ç¨³å®š (å˜åŠ¨é¢‘ç‡ < 1æ¬¡/å‘¨)
- âœ… æŒæ¡DockeråŸºç¡€æ“ä½œ
- âœ… éœ€è¦å¤–éƒ¨è®¿é—®æˆ–æ¼”ç¤º
- âœ… å›¢é˜Ÿåä½œéœ€è¦å…±äº«ç¯å¢ƒ

**å»ºè®®ï¼šå…ˆèŠ±1-2å¤©æ—¶é—´å®Œæˆæœ¬åœ°å®¹å™¨åŒ–ï¼Œç†Ÿæ‚‰Dockeråå†è€ƒè™‘äº‘ç«¯éƒ¨ç½²ï¼** ğŸš€
