# 🚀 QMS-AI 统一启动指南

**最新更新**: 2025-08-16  
**版本**: v2.1.0

---

## 📋 快速开始

### 🎯 推荐启动流程

1. **首次使用**: `QMS-START.bat` → 选择 "1. 完整启动"
2. **日常开发**: `QMS-Quick-Check-And-Start.bat`
3. **问题排查**: `diagnose-proxy-issue.bat`
4. **服务管理**: `QMS-Service-Manager.bat`

---

## 🚀 启动脚本详解

### 1. 主启动器 (推荐新用户)
```bash
QMS-START.bat
```
**功能特点**:
- 🎛️ 图形化菜单界面
- 🔧 多种启动模式选择
- 🏥 内置健康检查
- 🔄 支持全面重启

**菜单选项**:
1. **完整启动** - 自动检查环境，启动所有服务
2. **服务管理模式** - 交互式管理各个服务
3. **全面重启** - 清理并重新启动所有服务
4. **用户隔离系统** - 启动完整的认证和数据隔离
5. **健康检查** - 检查系统状态
6. **停止所有服务** - 安全停止所有服务

### 2. 快速启动 (推荐日常使用)
```bash
QMS-Quick-Check-And-Start.bat
```
**功能特点**:
- ⚡ 一键启动所有服务
- 🔍 自动环境检查
- 📦 自动依赖安装
- 🌐 自动端口检查
- ✅ 启动后验证

**启动顺序**:
1. 配置中心服务 (3003)
2. 聊天服务 (3004)
3. 认证服务 (8084)
4. 高级功能服务 (3009)
5. 导出服务 (3008)
6. Coze Studio服务 (3005)
7. API网关 (8085)
8. 应用端前端 (8081)
9. 配置端前端 (8072)

### 3. 服务管理器 (推荐开发者)
```bash
QMS-Service-Manager.bat
```
**功能特点**:
- 🎛️ 单独管理各个服务
- 📊 实时状态监控
- 🔄 支持启动/停止/重启
- 📋 详细的服务信息

---

## 🛠️ 问题诊断工具

### 代理问题诊断
```bash
diagnose-proxy-issue.bat
```
**检查项目**:
- 🌐 网络连接状态
- 🔌 端口监听状态
- 📁 配置文件检查
- 🗄️ 缓存目录检查
- 🔧 系统代理设置
- 🧪 连接测试

### 前端代理修复
```bash
fix-frontend-proxy-issue.bat
```
**修复步骤**:
1. 🛑 停止前端应用
2. 🧹 清理Vite缓存
3. 📦 重新安装依赖
4. 🚀 重启所有服务
5. ✅ 验证修复结果

### 服务状态检查
```bash
check-services-status.bat
```
**检查内容**:
- 🔌 端口监听状态
- 🏥 服务健康检查
- ❌ 错误端口检查
- 📊 服务响应测试

---

## 🌐 服务访问地址

### 前端应用
| 应用 | 端口 | 地址 | 功能 |
|------|------|------|------|
| **应用端** | 8081 | http://localhost:8081 | AI智能问答界面 |
| **配置端** | 8072 | http://localhost:8072 | 系统配置管理 |

### 后端服务
| 服务 | 端口 | 健康检查 | 功能 |
|------|------|----------|------|
| **配置中心** | 3003 | http://localhost:3003/health | 轻量级配置管理 |
| **聊天服务** | 3004 | http://localhost:3004/health | 8个AI模型接口 |
| **Coze Studio** | 3005 | http://localhost:3005/health | Coze Studio集成 |
| **导出服务** | 3008 | http://localhost:3008/health | 文档导出功能 |
| **高级功能** | 3009 | http://localhost:3009/health | 高级功能支持 |
| **认证服务** | 8084 | http://localhost:8084/health | 用户认证管理 |
| **API网关** | 8085 | http://localhost:8085/health | 统一API网关 |

---

## 🔐 登录凭据

### 默认用户账号
| 用户名 | 密码 | 角色 | 权限 |
|--------|------|------|------|
| **admin** | admin123 | 系统管理员 | 全部权限 |
| **developer** | dev123 | 开发工程师 | 开发权限 |
| **quality** | quality123 | 质量工程师 | 质量管理权限 |

---

## 🚨 常见问题解决

### Q1: 启动失败
**症状**: 脚本运行后服务无法启动
**解决方案**:
1. 运行 `QMS-Health-Check.bat` 检查环境
2. 确保Node.js版本 >= 18.0
3. 检查端口是否被占用
4. 运行 `diagnose-proxy-issue.bat` 详细诊断

### Q2: 前端连接错误
**症状**: 前端显示"连接被拒绝"或代理错误
**解决方案**:
1. 运行 `fix-frontend-proxy-issue.bat` 自动修复
2. 检查后端服务是否正常启动
3. 清理浏览器缓存 (Ctrl+Shift+Delete)
4. 等待1-2分钟让服务完全启动

### Q3: 端口被占用
**症状**: 启动时提示端口已被占用
**解决方案**:
1. 运行 `QMS-Stop-All.bat` 停止所有服务
2. 检查端口占用: `netstat -ano | findstr ":3004"`
3. 手动结束占用进程
4. 重新启动服务

### Q4: 依赖安装失败
**症状**: npm install 失败或依赖缺失
**解决方案**:
1. 检查网络连接
2. 清理npm缓存: `npm cache clean --force`
3. 删除node_modules文件夹
4. 重新运行启动脚本

---

## 🛑 停止服务

### 一键停止
```bash
QMS-Stop-All.bat
```

### 手动停止
关闭对应的命令行窗口即可

---

## 📞 技术支持

### 🔍 日志查看
- **聊天服务**: 查看"QMS AI - 聊天服务"窗口
- **应用端**: 查看"QMS AI - 应用端"窗口
- **配置端**: 查看"QMS AI - 配置端"窗口

### 🛠️ 调试模式
```bash
# 设置调试环境
set DEBUG=qms:*
set NODE_ENV=development

# 手动启动服务
cd backend/nodejs
node chat-service.js
```

### 📊 性能监控
- 访问 http://localhost:3004/health 查看聊天服务状态
- 访问 http://localhost:3003/health 查看配置中心状态

---

## 🎊 成功启动标志

当看到以下信息时，表示系统启动成功：

1. ✅ 所有端口正常监听
2. ✅ 前端应用可以正常访问
3. ✅ 健康检查接口返回200状态
4. ✅ AI模型可以正常对话

**🎉 恭喜！QMS-AI系统已成功启动！**

---

**需要帮助？** 运行相应的诊断脚本或查看日志获取详细信息。
